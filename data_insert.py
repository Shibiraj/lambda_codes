import re
import json
import boto3

dynamodb = boto3.resource('dynamodb')

def insert_data():
    """
    insert data to dynamo db
    :return:
    """
    table = dynamodb.Table('credential_data')
    rows = ['lovefilmi@yahoo.co.in:12s3t4p5','eshugupta_5535025@yahoo.co.in:9528095027','gwenqz20@maria.jazmyn.projectmy.in:g9l2d1fzPY','padsumbiya_prakash@yahoo.co.in:9925642371','pratighya.jain27@yahoo.in:685614686013532','indrajitpal_shis@yahoo.in:hombarna','tamilpavai@gcetly.ac.in:ilakiya123','a.kul2@yahoo.co.in:Veldenz3','amandeeppurba@yahoo.co.in:285630','kanet@nagpur.dot.net.in:shakeel123','prateekpagadala@absi.edu.in:anu','s-sergejj-z@yahoo.co.in:2703200','jayanthi_yugi@yahoo.co.in:jysh4','harenpanchal@yahoo.co.in:Seed721','ajayajn@yahoo.co.in:ajayja','n_karube@yahoo.co.in:umaikaru','padinjarekunnathrk@yahoo.co.in:rk19860420','vkmogha@yahoo.co.in:vkmogha','kkalpesh2@yahoo.co.in:207646','inf_plu_vb@yahoo.co.in:janu_9211','pradeep@imagine.co.in:imaginetechnologies','ganapathyr@hcl.in:kavitha1','kparathi@yahoo.co.in:nimiani','hemant_9749@yahoo.co.in:220800','rajeshvalecha71@yahoo.in:405887','msliceindjob1@yahoo.in:MS3188sp','ton.fuentes@yahoo.in:hamm19690','rahul_thorat27@yahoo.co.in:295049','pranaty2001@yahoo.co.in:24105774','mahimac.1895@yahoo.co.in:paru1324','annasq18@pop3storage.lavaweb.in:g9l2d1fzPY','vishnu.prakash@icai.in:VISHNU123.','panneer_selvam0283@yahoo.co.in:panneer388','piyush3dxyz@hackurmind.co.in:gtamexico123','newtron@airtelmail.in:NBDS1961','arunlal4u@yahoo.co.in:XD124UXD','cm.chaubey@yahoo.in:reiki0031','enidob2@maximumail.mineweb.in:g9l2d1fzPY','za_fs@yahoo.co.in:drowssa','srinivas@virtu.in:mother12','bhargav4as@yahoo.co.in:hanuman','mmdeshp@yahoo.co.in:prathamesh','anuragtrivedi97@live.in:anurag','pulkit_great_smart@yahoo.co.in:9255264400','purushothama.kavuri@yahoo.co.in:munnaa1985','inkypinky2405@yahoo.in:mother2405','tdpani06@yahoo.co.in:24081963','princesspuja2002@yahoo.co.in:merin1234567','rgshroff@yahoo.co.in:518340','nis_mca@yahoo.co.in:Need2change','ecdhaval@yahoo.co.in:digitallab','krishnacos@yahoo.co.in:jaimatadi','grld_chris@yahoo.co.in:grldcr77','piyush.pharma@yahoo.co.in:522676018219702','ukarthikraja@yahoo.co.in:ursksu11','dimdiodeasboolean@yahoo.co.in:evercode','mahima_bhat1986@yahoo.co.in:806613567155637','shahmegha0207@yahoo.co.in:india143','amit_pandey_8@yahoo.co.in:amit8420','shailisha_sai@yahoo.in:sonumysweetheart','dina_multimedia@yahoo.co.in:love123','prajith.prakash_1309@yahoo.co.in:13071986','bettieay20@angeliquekennedi.projectmy.in:g9l2d1fzPY','rspujar@yahoo.co.in:680878','ryansm22@yahoo.co.in:ryan159357','amit_panchal39@yahoo.co.in:amit1979','nagaraju0506@yahoo.co.in:Geeleendje!','isabellepx4@angeliquekennedi.projectmy.in:g9l2d1fzPY','gangmember1516@yahoo.in:t1i5OtjU0OQTAtGr','preeti_agrawal_amit@yahoo.co.in:alaypree1','www.sunny_saxena001@yahoo.co.in:wizard1','lizalk1@felicityaracely.minespace.in:x4ivyga51f','lyndaoz1@unique.anita.inlike.in:g9l2d1fzPY','nitu_pre06@yahoo.co.in:appu123123','pasupathyshanmugam2000@yahoo.co.in:lakshmi','geetashree49@yahoo.co.in:ak170349','hnazeer50@yahoo.in:969019','victorue60@mail0.lavaweb.in:g9l2d1fzpy','jai.lakhwani546@yahoo.in:765775','manikandan_ramachandran@yahoo.co.in:rmk','balaji_mcg@yahoo.co.in:671044','kelleylt18@angeliquekennedi.projectmy.in:g9l2d1fzPY','premnath.dinakaran@steria.co.in:german123','somnathc50@yahoo.co.in:ecexh','watchmissedlostepisodes@yahoo.in:19weed','dellahk1@angeliquekennedi.projectmy.in:g9l2d1fzPY','milind_bhandarkar@alfatechindia.in:saivilla','manoranjan_pati@yahoo.co.in:674503','micku_singh2007@yahoo.co.in:635230230029446','www.nidhi_aquarian@yahoo.co.in:alice786','rinix_28sors@yahoo.co.in:khupson','alycexf1@madalyn.alisha.katkit.in:g9l2d1fzPY','pariveshsinghbhadouriya@yahoo.in:06021989','anilsahni19feb@yahoo.co.in:416388','rahul_8_8@yahoo.co.in:ramjane','donnatq18@gamingmail.mineweb.in:g9l2d1fzPY','guyyy2@vp113.lavaweb.in:x4ivygA51F','vgopi1971@yahoo.co.in:gobisudha','goelayush91@yahoo.in:523168','jasonyo3@angeliquekennedi.projectmy.in:g9l2d1fzPY','vasukdevarao@yahoo.co.in:kvrc_vj','jay_acts@yahoo.co.in:rajjujay','tabrez_kureshi@yahoo.co.in:896879','yvettexc60@piscium.minemail.in:x4ivygA51F','manimegalait@ssn.edu.in:sooryaazh1015','bjn.cse@rmkec.ac.in:akashabhilash','kus727@yahoo.in:mahamaza','mariaiq2@madalyn.alisha.katkit.in:g9l2d1fzPY','guynextdoor_in16@yahoo.co.in:shubhosen','talha_mostwanted786@yahoo.co.in:pureblood786','parasuchandra@yahoo.co.in:chandranvalakom','thomaskc1@blockpost1.inlike.in:g9l2d1fzPY','carlyzg5@galaxymail.lavaweb.in:g9l2d1fzPY','jecttrobery@rizet.in:88z4rsdBdW','kkarthikks@yahoo.co.in:techindia','pradeepsampath_1983@yahoo.co.in:lionking1','sing_nitya@yahoo.co.in:beautiful','prateek_anurag@yahoo.co.in:chocolatecondom','mwchangdebbarma@yahoo.in:mwchang123','priyanshi.saini@yahoo.in:nationalschoolofdrama','kevintn7@angeliquekennedi.projectmy.in:g9l2d1fzPY','sukh_941979@yahoo.in:maalaxmi','priyanka_grover51@yahoo.co.in:radhaswamiji','tommyfd16@baylee.alexia.katkit.in:g9l2d1fzPY','tchp@live.in:deipong2007','rajith.bkr@rvce.edi.in:likin.','jntuworld01@yahoo.in:9553530226','palsonkennedyr@yahoo.co.in:2007419223','shanidev75@yahoo.in:omsairam786','lakshmipalaniappan@yahoo.co.in:9u9u9u9u9u','pradeeparajendran@yahoo.co.in:tamilselvan','terrywu3@angeliquekennedi.projectmy.in:g9l2d1fzPY','scientistrubin@yahoo.co.in:indegofera','prakash.kumar@itcwelcomgroup.in:prameesam','poxkrdueh432401574@ololomail.in:1234567qq','pradeep_upadhyay2003@yahoo.co.in:saritaji','nicholasks6@baylee.alexia.katkit.in:g9l2d1fzPY','prakash_deathhallow@yahoo.co.in:mandeep08','sriniredrose@yahoo.co.in:welcome','srijithg@yahoo.co.in:sarianidi','kiruba_251@yahoo.co.in:blessme123','anshul_1978@yahoo.co.in:9989cc02','jatins1986@yahoo.co.in:jateen','brij@airtelmail.in:brij168','ravimishra1964@yahoo.co.in:9871380583','harrietwp1@maliaalondra.inlike.in:g9l2d1fzPY','anil@vandm.co.in:change','radiomirchi_technical@yahoo.co.in:patrick','anujakshatriya@yahoo.co.in:qwer123','jeanneii60@baylee.alexia.katkit.in:g9l2d1fzPY','harish_bhati1020@yahoo.co.in:harish','hemant_gajre@yahoo.co.in:8351824','rani.jaya@yahoo.co.in:kuttypayan','marciuf20@araceli.madalyn.katkit.in:g9l2d1fzPY','reena20113@yahoo.in:spikenm11','vamshi_sep23@yahoo.co.in:pikachu23','pushpendra23saharan@yahoo.co.in:1o9o13915','mailtopravsharma@yahoo.co.in:sushmailoveyou','paulineff18@mailstorage.minespace.in:g9l2d1fzPY','craigbo2@baylee.alexia.katkit.in:g9l2d1fzPY','virus96@live.in:nanavati','srn_nsr@yahoo.co.in:ninaashwani','anandvatnal@yahoo.co.in:bond007','cathleennp1@baylee.alexia.katkit.in:g9l2d1fzPY','simulnath@yahoo.co.in:kajipara1','musheer.sharieff@yahoo.co.in:tareen2musheer','krishnaraparla@yahoo.co.in:chowdary','pinballbnav@crablove.in:1c2ba020245b5e321','akhilesh_vermasp@yahoo.co.in:9907027786','kdsharma84@yahoo.co.in:ekta1983','pramod07.singh@yahoo.co.in:raman9313444226','kalyani_ashish@yahoo.co.in:912238','s.s1@live.in:9302686901','jhshah4u@yahoo.co.in:PURVA145','web_nik@yahoo.co.in:monitor','dolfin_03@yahoo.co.in:9913549427','lucilleth2@unique.anita.inlike.in:g9l2d1fzPY','iphone1426@yahoo.in:iPhone1426','mysoregreenicecreem@yahoo.co.in:avatisecret','silkmachen01@cust.in:ric1lus2at','zia_arshadkhan@yahoo.co.in:923529','dkubendran@yahoo.co.in:Kubs1978','shikhapln@yahoo.in:radhasoami','eddielb2@madalyn.alisha.katkit.in:g9l2d1fzPY','borheiredeerabn@baidubaidu123123.in:Kauub911dZ','syedbhat2002@yahoo.co.in:robertics','ja_nu_06@yahoo.co.in:573465','ryansanthu@yahoo.co.in:prarthana','rishugeeta@yahoo.co.in:667357','mindykx69@androidmail.mineweb.in:g9l2d1fzpy','kittyff1@unique.anita.inlike.in:g9l2d1fzPY','masterinall_jackinnone@yahoo.co.in:october3','nekshta_2812@yahoo.in:nekshta2812','kandarp_jha2003@yahoo.co.in:Kandarp','bridgettmh11@etno.mineweb.in:x4ivygA51F','tmahima94@yahoo.in:9911000140','bhavika_sodha@yahoo.in:omsainath','veeramani_v@yahoo.co.in:900546','pritam.bhattacharyya@yahoo.co.in:sekeniso','huxley_jr@yahoo.in:fiyarnik']
    # writes data as batch-wise to dynamodb
    with table.batch_writer() as batch:
        for i, row in enumerate(rows, 1):
            email, pwd = row.split(':')
            # extracts domain from input data
            domain = re.search(r"@([\w.]+)", row)
            full_domain = domain.group(1)
            domain = full_domain.split('.')[0]
            # final data for insertion
            item = {'id' : i,  'email' : email, 'pwd' : pwd, 'full_domain' : full_domain, 'domain' : domain}
            batch.put_item(Item=item)
            print("Inserted : row : {}".format(i))
    print("All done")
    
def lambda_handler(event, context):
    """

    :param event:  type dict
    :param context: type LambdaContext
    :return:
    """
    insert_data()
    return {
        'statusCode': 200,
        'body': json.dumps('Data inserted!')
    }
